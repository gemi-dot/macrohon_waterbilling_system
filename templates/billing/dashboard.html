{% extends 'billing/base.html' %}
{% block title %}Dashboard{% endblock %}
{% block page_title %}Dashboard{% endblock %}
{% block content %}
 
<div class='row mb-4'>
  <div class='col-md-3'>
    <div class='card stat-card' style='border-color:#2575C4;'>
      <div class='card-body'>
        <h6 class='text-muted'>Active Subscribers</h6>
        <h2 class='text-primary'>{{ active_subscribers }}</h2>
        <small>of {{ total_subscribers }} total</small>
      </div>
    </div>
  </div>
  <div class='col-md-3'>
    <div class='card stat-card' style='border-color:#dc3545;'>
      <div class='card-body'>
        <h6 class='text-muted'>Unpaid Bills</h6>
        <h2 class='text-danger'>{{ unpaid_bills }}</h2>
        <small class='text-danger'>{{ overdue_bills }} overdue</small>
      </div>
    </div>
  </div>
  <div class='col-md-3'>
    <div class='card stat-card' style='border-color:#28a745;'>
      <div class='card-body'>
        <h6 class='text-muted'>Collected Today</h6>
        <h2 class='text-success'>&#8369;{{ collection_today|floatformat:2 }}</h2>
      </div>
    </div>
  </div>
  <div class='col-md-3'>
    <div class='card stat-card' style='border-color:#fd7e14;'>
      <div class='card-body'>
        <h6 class='text-muted'>This Month Collection</h6>
        <h2 class='text-warning'>&#8369;{{ collection_month|floatformat:2 }}</h2>
      </div>
    </div>
  </div>
</div>
 
<!-- Quick Actions Section -->
<div class='row mb-4'>
  <div class='col-md-12'>
    <div class='card'>
      <div class='card-header bg-info text-white'>
        <i class='fa fa-bolt'></i> Quick Actions
      </div>
      <div class='card-body'>
        <div class='row'>
          <div class='col-md-4'>
            <a href="{% url 'general-ledger' %}" class='btn btn-outline-primary btn-block mb-2'>
              <i class='fa fa-book'></i> General Ledger
            </a>
          </div>
          <div class='col-md-4'>
            <a href="{% url 'subscriber-list' %}" class='btn btn-outline-success btn-block mb-2'>
              <i class='fa fa-users'></i> View Subscribers
            </a>
          </div>
          <div class='col-md-4'>
            <a href="{% url 'bill-list' %}" class='btn btn-outline-danger btn-block mb-2'>
              <i class='fa fa-file-invoice'></i> View Bills
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class='card'>
  <div class='card-header bg-primary text-white'>
    <i class='fa fa-history'></i> Recent Payments
  </div>
  <div class='card-body p-0'>
    <table class='table table-hover mb-0'>
      <thead class='thead-light'>
        <tr><th>Date</th><th>Account</th><th>Subscriber</th><th>OR #</th><th>Amount</th></tr>
      </thead>
      <tbody>
      {% for p in recent_payments %}
        <tr>
          <td>{{ p.entry_date|date:'M d, Y' }}</td>
          <td><a href="{% url 'subscriber-detail' p.subscriber.pk %}">{{ p.subscriber.account_number }}</a></td>
          <td>{{ p.subscriber.full_name }}</td>
          <td>{{ p.or_number }}</td>
          <td class='text-right font-weight-bold'>&#8369;{{ p.credit|floatformat:2 }}</td>
        </tr>
      {% empty %}
        <tr><td colspan='5' class='text-center text-muted'>No payments today</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
